<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:iis="http://wixtoolset.org/schemas/v4/wxs/iis" xmlns:netfx="http://wixtoolset.org/schemas/v4/wxs/netfx">
  <Fragment>
    <ComponentGroup Id="webSite">
      <ComponentRef Id="webSite" />
    </ComponentGroup>
    <PropertyRef Id="IISMAJORVERSION" />
    <netfx:DotNetCoreSearch RuntimeType="aspnet" MajorVersion="7" Platform="x64" Variable="ASPNETCOREVERSION"/>
    <Launch Condition="Installed OR IISMAJORVERSION" Message="[ProductName] requires Microsoft IIS"/>
    <Launch Condition="Installed OR ASPNETCOREVERSION" Message="[ProductName] requires ASP.NET Core 7.x (Hosting Bundle)"/>
    <DirectoryRef Id="INSTALLLOCATION">
      <Directory Id="webSite" Name="WebSite">
        <Component Id="webSite" Guid="5b5ea13b-ba42-4889-bd3c-0790c4928bde" KeyPath="yes">
          <iis:WebAppPool Id="webSite" Name="WebAPI" Identity="applicationPoolIdentity" ManagedRuntimeVersion="v4.0" ManagedPipelineMode="Integrated"/>
          <iis:WebSite Id="webSite" SiteId="*" Description="WebAPI Web Site" Directory="webSite" ConfigureIfExists="no">
            <iis:WebAddress Id="webSite" Port="8080" />
            <iis:WebDirProperties Id="webSite" AnonymousAccess="yes" WindowsAuthentication="no" />
            <iis:WebApplication Id="webSite" WebAppPool="webSite" Name="webSite" />
          </iis:WebSite>
        </Component>
      </Directory>
    </DirectoryRef>
  </Fragment>
</Wix>